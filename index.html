<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friscolanti Funeral Chapel Obituary Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f9fafb;
            font-family: 'Inter', sans-serif;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
            color: #1f2937;
        }
        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .btn {
            background-color: #3b82f6;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .btn:hover {
            background-color: #2563eb;
        }
        .btn:disabled {
            background-color: #93c5fd;
            cursor: not-allowed;
        }
        #obituaryOutput {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.375rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-top: 2rem;
        }
        /* Loading spinner styles */
        .loader {
            display: none;
            margin: 1rem auto;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">Friscolanti Funeral Chapel Obituary Generator</h1>
        <p class="text-gray-600 mb-6">Enter details to generate a heartfelt obituary. Leave any field blank if desired.</p>

        <form id="obituaryForm" class="space-y-6">
            <div class="form-group">
                <label for="fullName">Full Name</label>
                <input type="text" id="fullName" name="fullName" placeholder="Enter full name">
            </div>

            <div class="form-group">
                <label for="birthDate">Birth Date</label>
                <input type="text" id="birthDate" name="birthDate" placeholder="e.g., January 1, 1950">
            </div>

            <div class="form-group">
                <label for="deathDate">Date of Passing</label>
                <input type="text" id="deathDate" name="deathDate" placeholder="e.g., August 1, 2025">
            </div>

            <div class="form-group">
                <label for="placeOfPassing">Place of Passing</label>
                <input type="text" id="placeOfPassing" name="placeOfPassing" placeholder="e.g., St. Joseph's Health Care">
            </div>

            <div class="form-group">
                <label for="birthplace">Birthplace</label>
                <input type="text" id="birthplace" name="birthplace" placeholder="e.g., Hamilton, Ontario">
            </div>

            <div class="form-group">
                <label for="relocation">Immigration or Relocation Details</label>
                <input type="text" id="relocation" name="relocation" placeholder="e.g., Immigrated from Italy in 1960">
            </div>

            <div class="form-group">
                <label for="heritage">Cultural Heritage or Values</label>
                <input type="text" id="heritage" name="heritage" placeholder="e.g., Proud Italian heritage">
            </div>

            <div class="form-group">
                <label for="family">Family Members</label>
                <textarea id="family" name="family" rows="4" placeholder="e.g., spouse Jane Doe, the late son John Doe, daughter Sarah; use 'the late' for deceased"></textarea>
            </div>

            <div class="form-group">
                <label for="hobbies">Hobbies and Interests</label>
                <textarea id="hobbies" name="hobbies" rows="4" placeholder="e.g., Gardening, painting, volunteering"></textarea>
            </div>

            <div class="form-group">
                <label for="career">Career or Achievements</label>
                <textarea id="career" name="career" rows="4" placeholder="e.g., Retired teacher, community leader"></textarea>
            </div>

            <div class="form-group">
                <label for="donations">Donation Preferences</label>
                <input type="text" id="donations" name="donations" placeholder="e.g., Heart and Stroke Foundation">
            </div>

            <div class="form-group">
                <label for="thanks">Special Thank Yous</label>
                <textarea id="thanks" name="thanks" rows="4" placeholder="e.g., Thank you to the staff at St. Peter's Hospital"></textarea>
            </div>

            <div class="form-group">
                <label for="visitation">Visitation Dates/Times</label>
                <textarea id="visitation" name="visitation" rows="4" placeholder="e.g., Visitation on August 10, 2025, from 2-4 PM and 7-9 PM"></textarea>
            </div>

            <div class="form-group">
                <label for="funeralService">Funeral Service Details</label>
                <textarea id="funeralService" name="funeralService" rows="4" placeholder="e.g., Service at St. Mary's Church on August 11, 2025, at 10 AM"></textarea>
            </div>

            <div class="form-group">
                <label for="burial">Burial or Entombment Details</label>
                <input type="text" id="burial" name="burial" placeholder="e.g., Holy Sepulchre Cemetery">
            </div>

            <button type="submit" class="btn" id="submitButton">Generate Obituary</button>
        </form>

        <div class="loader" id="loader"></div>

        <div id="obituaryOutput" class="hidden">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">Generated Obituary</h2>
            <p id="obituaryText" class="text-gray-700"></p>
        </div>
    </div>

    <script>
        document.getElementById('obituaryForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Show loader and disable button
            const loader = document.getElementById('loader');
            const submitButton = document.getElementById('submitButton');
            loader.style.display = 'block';
            submitButton.disabled = true;

            // Collect form data
            const fullName = document.getElementById('fullName').value || '[Full Name]';
            const birthDate = document.getElementById('birthDate').value || '[Birth Date]';
            const deathDate = document.getElementById('deathDate').value || '[Date of Passing]';
            const placeOfPassing = document.getElementById('placeOfPassing').value || '[Place of Passing]';
            const birthplace = document.getElementById('birthplace').value || '[Birthplace]';
            const relocation = document.getElementById('relocation').value || '';
            const heritage = document.getElementById('heritage').value || '';
            const family = document.getElementById('family').value || '[Family Members]';
            const hobbies = document.getElementById('hobbies').value || '[Hobbies and Interests]';
            const career = document.getElementById('career').value || '[Career or Achievements]';
            const donations = document.getElementById('donations').value || '';
            const thanks = document.getElementById('thanks').value || '';
            const visitation = document.getElementById('visitation').value || '';
            const funeralService = document.getElementById('funeralService').value || '[Funeral Service Details]';
            const burial = document.getElementById('burial').value || '[Burial or Entombment Details]';

            // Calculate age (simple year-based calculation)
            let age = '[Age]';
            if (birthDate !== '[Birth Date]' && deathDate !== '[Date of Passing]') {
                const birthYear = parseInt(birthDate.match(/\d{4}/));
                const deathYear = parseInt(deathDate.match(/\d{4}/));
                if (birthYear && deathYear) {
                    age = deathYear - birthYear;
                }
            }

            // Construct visitation details with fixed location
            const visitationDetails = `Visitation at FRISCOLANTI FUNERAL CHAPEL, 43 Barton St. E. ${visitation ? `on ${visitation}.` : ''}`;

            // Construct a prompt for Cohere
            const prompt = `Generate a heartfelt, professional obituary for ${fullName}, born on ${birthDate} in ${birthplace}, who passed away peacefully at ${placeOfPassing} on ${deathDate}, at the age of ${age}. 
Include only the following details exactly as provided, without adding or inventing any names, websites, or additional information. For deceased family members, use 'the late' as provided (e.g., 'the late John Doe'). 
${relocation ? `Immigration/relocation: ${relocation}. ` : ''}${heritage ? `Cultural heritage: ${heritage}. ` : ''}Family: ${family}. 
Hobbies: ${hobbies}. Career/achievements: ${career}. ${donations ? `Donations to: ${donations}. ` : ''}${thanks ? `Special thanks: ${thanks}. ` : ''}Visitation: ${visitationDetails}. Funeral service: ${funeralService}. Burial: ${burial}. 
Do not include any condolence websites or external links. Make it warm, concise, and around 200-300 words.`;

            // Cohere API key
            const apiKey = 'tGs2ZSjQdvUrHD8cKcMUFGvpGK7BgFaVgABgQmJl';

            try {
                const response = await fetch('https://api.cohere.ai/v1/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'command', // Cohere's text generation model
                        prompt: prompt,
                        max_tokens: 500,
                        temperature: 0.7
                    })
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                const obituary = data.generations[0].text.trim();

                // Display the result
                const outputDiv = document.getElementById('obituaryOutput');
                const outputText = document.getElementById('obituaryText');
                outputText.textContent = obituary;
                outputDiv.classList.remove('hidden');
            } catch (error) {
                console.error('Error generating obituary:', error);
                alert('Failed to generate obituary. Check console for details.');
            } finally {
                // Hide loader and re-enable button
                loader.style.display = 'none';
                submitButton.disabled = false;
            }
        });
    </script>
</body>
</html>
